state user_prompt
    match /[Uu]sername/

state pass_prompt
    match /[Pp]assword: ?$/

state priv_exec_pass
    match /[Pp]assword: ?$/

state user_exec
    match /> ?$/

state priv_exec
    match /# ?$/

state configure
    match /\(config[^)]*\)# ?$/


from user_prompt to pass_prompt
    send %s

from pass_prompt to user_exec
    send %s

from user_exec to priv_exec_pass
    send enable

from priv_exec_pass to priv_exec
    send %s

from priv_exec to user_exec
    send disable

from priv_exec to configure
    send configure terminal

from configure to priv_exec
    send exit

macro to_user_exec
    match /[Uu]sername/
    send %s
    match /[Pp]assword: ?$/
    send %s
    match /> ?$/

macro to_priv_exec
    send enable
    match /[Pp]assword: ?$/
    send %s
    match /# ?$/

macro write_mem
    send copy running-config startup-config
    match /Destination filename \[startup-config\]\?$/
    send startup-config

macro show_run
    send show running-config
    continuation / --More-- /

macro show_int_br
    send show ip int br
    send show ip int br
